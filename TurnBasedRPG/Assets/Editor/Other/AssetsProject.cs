using System.Collections;
using System.Collections.Generic;
using System.IO;
using System.Text;
using UnityEditor;
using UnityEngine;

/// <summary>
/// 参考连接：https://blog.csdn.net/liqiangeastsun/article/details/42124283
/// https://blog.csdn.net/LIQIANGEASTSUN/article/details/42173941
/// </summary>
public class AssetsProject : MonoBehaviour
{
    #region 旧版代码
    //[MenuItem("Assets/测试Project目录")]
    //public static void Search()
    //{
    //    StringBuilder sb = new StringBuilder();
    //    // 获取所有选中 文件、文件夹的 GUID
    //    string[] guids = Selection.assetGUIDs;
    //    foreach (var guid in guids)
    //    {
    //        // 将 GUID 转换为 路径
    //        string assetPath = AssetDatabase.GUIDToAssetPath(guid);
    //        // 判断是否文件夹
    //        if (Directory.Exists(assetPath))
    //        {
    //            SearchDirectory(sb, assetPath);
    //        }
    //    }
    //    Debug.Log(sb);
    //}

    //private static string _extension = "*.anim";
    //static void SearchDirectory(StringBuilder sb, string directory)
    //{
    //    DirectoryInfo dInfo = new DirectoryInfo(directory);
    //    // 获取 文件夹以及子文件加中所有扩展名为  _extension 的文件
    //    FileInfo[] fileInfoArr = dInfo.GetFiles(_extension, SearchOption.AllDirectories);
    //    for (int i = 0; i < fileInfoArr.Length; ++i)
    //    {
    //        string fullName = fileInfoArr[i].FullName;
    //        sb.AppendLine(fullName);
    //    }
    //}
    #endregion

    private static string prefabLoadPath = "Prefabs";//Resourcesm目录下的
    private static string ClassName = "ConfigUIPrefab";

    [MenuItem("Assets/生成需要加载的物体的配置文件")]
    public static void SearchPrefab()
    {
        //输出内容
        StringBuilder sb = new StringBuilder();
        sb.AppendLine($"public static class {ClassName}");
        sb.AppendLine("{");
        sb.AppendLine("\t#region 需要加载的物体的名称");
        Transform[] tf = Resources.LoadAll<Transform>(prefabLoadPath);
        if (tf.Length == 0) { Debug.Log("路径错误"); }
        foreach (var item in tf) { sb.AppendLine($"\tpublic static string {item.name} => \"{item.name}\";"); }
        sb.AppendLine("\t#endregion");
        sb.AppendLine("}");

        //生成文件
        string filePath = $"{Application.dataPath}/Core/Resource/PrefabMgr/{ClassName}.cs";
        if (File.Exists(filePath)) { File.Delete(filePath); }
        using (StreamWriter writer = File.CreateText(filePath)) { writer.Write(sb); Debug.Log("内容写入成功!"); }
        AssetDatabase.Refresh();
    }
}
